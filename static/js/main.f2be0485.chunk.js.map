{"version":3,"sources":["store/reducers/rootReducer.js","store/store.js","store/actions/actions.js","components/Join.js","components/Message.js","components/AddMessage.js","components/Preloader.js","components/Header.js","components/Chat.js","components/JoinByLink.js","history.js","App.js","index.js"],"names":["rootReducer","state","action","type","user","payload","store","createStore","set_user","value","Join","location","useState","name","setName","room","setRoom","dispatch","useDispatch","history","useHistory","className","onSubmit","event","preventDefault","push","placeholder","onChange","target","onInput","Message","userName","messageText","isYourMessage","time","Date","toTimeString","split","AddMessage","sendMessage","message","setMessage","trim","Preloader","Header","users","length","map","i","id","onClick","Chat","setUsers","messages","setMessages","isLoading","setIsLoading","chatWrapperRef","React","useRef","socket","io","useSelector","useEffect","querystring","parse","search","current","emit","on","prevState","scrollTo","top","scrollHeight","left","behavior","disconnect","off","connected","to","ref","msg","text","createHashHistory","App","path","exact","component","JoinByLink","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.f2be0485.chunk.js","sourcesContent":["function rootReducer(state, action) {\r\n  switch (action.type) {\r\n    case \"SET\":\r\n      return { user: action.payload };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\nexport default rootReducer;\r\n","import { createStore } from \"redux\";\r\nimport rootReducer from \"./reducers/rootReducer\";\r\n\r\nconst initialState = { user: \"\" };\r\n\r\nconst store = createStore(rootReducer, initialState);\r\n\r\nexport default store;\r\n","export function set_user(value) {\r\n  return {\r\n    type: \"SET\",\r\n    payload: value,\r\n  };\r\n}\r\n","import React, { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useHistory } from \"react-router-dom\";\nimport { set_user } from \"../store/actions/actions\";\nimport \"./Join.css\";\n\nexport default function Join({ location }) {\n  const [name, setName] = useState(\"\");\n  const [room, setRoom] = useState(\"\");\n  const dispatch = useDispatch();\n  const history = useHistory();\n\n  const submitHandler = (event) => {\n    event.preventDefault();\n    if (!name || !room) return;\n    dispatch(set_user(name));\n    history.push(`/chat?room=${room}`);\n  };\n\n  return (\n    <div className=\"join-wrapper\">\n      <form className=\"join\" onSubmit={submitHandler}>\n        <h1 className=\"join__header\">Join to the chat</h1>\n        <label className=\"join__input-label\">Enter your name</label>\n        <input\n          placeholder=\"Name\"\n          type=\"text\"\n          onChange={(event) => setName(event.target.value)}\n        />\n        <label className=\"join__input-label\">Enter a room name</label>\n        <input\n          placeholder=\"Room\"\n          type=\"text\"\n          onInput={(event) => setRoom(event.target.value)}\n        />\n        <button className=\"join__button\" type=\"submit\">\n          Join\n        </button>\n      </form>\n    </div>\n  );\n}\n","import React from \"react\";\nimport \"./Message.css\";\n\nexport default function Message({\n  userName,\n  messageText,\n  isYourMessage,\n  time,\n}) {\n  const dateFormate = () => {\n    const date = new Date(time);\n    return date.toTimeString().split(\" \")[0];\n  };\n  return (\n    <div className=\"chat-message\">\n      <div\n        className={\n          isYourMessage ? \"chat-user  chat-user_your-message\" : \"chat-user\"\n        }\n      >\n        <p className=\"chat-user__name\">{userName}</p>\n        <p className=\"chat-message__time\">{dateFormate()}</p>\n      </div>\n      <p\n        className={\n          isYourMessage\n            ? \"chat-message__content chat-message__content_your-message\"\n            : \"chat-message__content\"\n        }\n      >\n        {messageText}\n      </p>\n    </div>\n  );\n}\n","import React, { useState } from \"react\";\nimport \"./AddMessage.css\";\n\nexport default function AddMessage({ sendMessage }) {\n  const [message, setMessage] = useState(\"\");\n  return (\n    <div className=\"add-message\">\n      <form\n        className=\"form-add-message\"\n        onSubmit={(event) => {\n          event.preventDefault();\n          sendMessage(message.trim());\n          setMessage(\"\");\n        }}\n      >\n        <input\n          className=\"form-add-message__input\"\n          value={message}\n          onChange={(event) => setMessage(event.target.value)}\n        />\n        <button className=\"form-add-message__button\" type=\"submit\">\n          Send\n        </button>\n      </form>\n    </div>\n  );\n}\n","import React from 'react';\r\nimport './Preloader.css';\r\n\r\nfunction Preloader() {\r\n    return (\r\n        <section className=\"preloader\">\r\n            <i className=\"circle-preloader\"></i>\r\n        </section>\r\n    )\r\n}\r\n\r\nexport default Preloader;","import React from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport \"./Header.css\";\n\nexport default function Header({ users, room }) {\n  const history = useHistory();\n  return (\n    <header className=\"header\">\n      <div className=\"header__users\">\n        {`In the room \"${room}\" ${users.length} users online: `}\n        {users.map((user, i) => (\n          <span key={user.id}>\n            <span className=\"header__user\">{user.name}</span>\n            {users.length > 1 && i < users.length - 1 && \", \"}\n          </span>\n        ))}\n      </div>\n      <button onClick={() => history.push(\"/\")} className=\"header__button\">\n        Log out\n      </button>\n    </header>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport querystring from \"query-string\";\nimport io from \"socket.io-client\";\nimport { useSelector } from \"react-redux\";\nimport { Redirect } from \"react-router-dom\";\nimport Message from \"./Message\";\nimport AddMessage from \"./AddMessage\";\nimport Preloader from \"./Preloader\";\nimport \"./Chat.css\";\nimport Header from \"./Header\";\nconst ENDPOINT = \"https://socket-io-chat-456.herokuapp.com/\";\n//const ENDPOINT = \"http://localhost:5000/\";\n\nexport default function Chat({ location }) {\n  const [name, setName] = useState(\"\");\n  const [room, setRoom] = useState(\"\");\n  const [users, setUsers] = useState([]);\n  const [messages, setMessages] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const chatWrapperRef = React.useRef(null);\n  const socket = React.useRef(io(ENDPOINT));\n\n  const userName = useSelector((state) => state.user);\n\n  useEffect(() => {\n    const { room } = querystring.parse(location.search);\n    setName(userName);\n    setRoom(room);\n    socket.current.emit(\"join\", { name: userName, room }, () => {});\n    socket.current.on(\"message\", (message) => {\n      setMessages((prevState) => [...prevState, message]);\n      chatWrapperRef.current.scrollTo({\n        top: chatWrapperRef.current.scrollHeight,\n        left: 0,\n        behavior: \"smooth\",\n      });\n    });\n    socket.current.on(\"roomData\", ({ users }) => {\n      setUsers(users);\n    });\n    return () => {\n      socket.current.disconnect();\n      socket.current.off();\n    };\n  }, [location.search, userName]);\n\n  useEffect(() => {\n    socket.current.connected && setIsLoading(false);\n  }, [socket.current.connected]);\n\n  function sendMessage(message) {\n    if (message) socket.current.emit(\"sendMessage\", message, () => {});\n  }\n\n  return (\n    <>\n      {room && !userName && <Redirect to={`/joinByLink?room=${room}`} />}\n      <div className=\"chat-wrapper\">\n        <Header users={users} room={room} />\n        <div className=\"chat-messages-wrapper\" ref={chatWrapperRef}>\n          {isLoading ? (\n            <Preloader />\n          ) : (\n            <>\n              {messages.map((msg, i) => (\n                <Message\n                  key={i}\n                  userName={msg.user}\n                  messageText={msg.text}\n                  isYourMessage={msg.user === name}\n                  time={msg.time}\n                />\n              ))}\n            </>\n          )}\n        </div>\n\n        <AddMessage sendMessage={sendMessage} />\n      </div>\n    </>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport querystring from \"query-string\";\nimport { useDispatch } from \"react-redux\";\nimport { set_user } from \"../store/actions/actions\";\nimport \"./JoinByLink.css\";\n\nexport default function Join({ location }) {\n  const [name, setName] = useState(\"\");\n  const [room, setRoom] = useState(\"\");\n  const dispatch = useDispatch();\n  const history = useHistory();\n\n  useEffect(() => {\n    const { room } = querystring.parse(location.search);\n    if (room) setRoom(room);\n  }, [location.search]);\n\n  const submitHandler = (event) => {\n    event.preventDefault();\n    if (!name || !room) return;\n    dispatch(set_user(name));\n    history.push(`/chat?room=${room}`);\n  };\n\n  return (\n    <div className=\"join-by-link-wrapper\">\n      <form className=\"join-by-link\" onSubmit={submitHandler}>\n        <h1 className=\"join-by-link__header\">\n          You has joined to the room \"{room}\"\n        </h1>\n        <label className=\"join-by-link__input-label\">Enter your name</label>\n        <input\n          placeholder=\"Name\"\n          type=\"text\"\n          onChange={(event) => setName(event.target.value)}\n        />\n        <button className=\"join-by-link__button\" type=\"submit\">\n          Join\n        </button>\n      </form>\n    </div>\n  );\n}\n","import { createHashHistory } from \"history\";\n\nexport default createHashHistory();\n","import React from \"react\";\nimport { Router, Route, Switch } from \"react-router-dom\";\nimport Join from \"./components/Join\";\nimport Chat from \"./components/Chat\";\nimport JoinByLink from \"./components/JoinByLink\";\nimport history from \"./history\";\nimport \"./App.css\";\n\nexport default function App() {\n  return (\n    <Router history={history}>\n      <Switch>\n        <Route path=\"/\" exact component={Join} />\n        <Route path=\"/joinByLink\" component={JoinByLink} />\n        <Route path=\"/chat\" component={Chat} />\n      </Switch>\n    </Router>\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport store from \"./store/store\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}